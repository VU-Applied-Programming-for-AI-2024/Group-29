<!DOCTYPE html>
<html>
<head>
    <title>MYTEAM</title>

    <script>
        function handleSubmit(event) {
            event.preventDefault(); 

            const sport = document.getElementById('sport').value;
            const league = document.getElementById('league').value;
            const team = document.getElementById('team').value;
            const custom = document.getElementById('customNotification').value; 
            const notify = document.getElementById('notify').checked;
            document.getElementById('message').innerText = "Thank you for signing up! Excited?";
        

            const formData = {
                sport: sport,
                league: league,
                team: team,
                custom: custom,
                notify: notify
            };

            fetch('/api/submit', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(formData)
            })
            .then(response => response.json())
            .then(data => {
                console.log(data);
                document.getElementById('message').innerText = data.message; 
            })
            .catch(error => {
                console.error('Error:', error);
            });
        }
            
        function updateTeams() {
            const league = document.getElementById('league').value;
            const teamsDropdown = document.getElementById('team');
            const customNotificationDiv = document.getElementById('customNotificationDiv');
            const customDropdown = document.getElementById('customNotification'); 

            const teamsByLeague = {
                "EPL": [
                    { value: "arsenal", text: "Arsenal" },
                    { value: "aston-villa", text: "Aston Villa" },
                    { value: "bournemouth", text: "Bournemouth" },
                    { value: "brentford", text: "Brentford" },
                    { value: "brighton", text: "Brighton & Hove Albion" },
                    { value: "burnley", text: "Burnley" },
                    { value: "chelsea", text: "Chelsea" },
                    { value: "crystal-palace", text: "Crystal Palace" },
                    { value: "everton", text: "Everton" },
                    { value: "fulham", text: "Fulham" },
                    { value: "liverpool", text: "Liverpool" },
                    { value: "luton-town", text: "Luton Town" },
                    { value: "manchester-city", text: "Manchester City" },
                    { value: "manchester-united", text: "Manchester United" },
                    { value: "newcastle-united", text: "Newcastle United" },
                    { value: "nottingham-forest", text: "Nottingham Forest" },
                    { value: "sheffield-united", text: "Sheffield United" },
                    { value: "tottenham-hotspur", text: "Tottenham Hotspur" },
                    { value: "west-ham-united", text: "West Ham United" },
                    { value: "wolverhampton-wanderers", text: "Wolverhampton Wanderers" }
                ],
                "La Liga": [
                    { value: "real-madrid", text: "Real Madrid" },
                    { value: "barcelona", text: "Barcelona" },
                    { value: "atletico-madrid", text: "Atletico Madrid" },
                    { value: "valencia", text: "Valencia" },
                    { value: "sevilla", text: "Sevilla" }
                ]
            };

            teamsDropdown.innerHTML = "";
            if (teamsByLeague[league]) {
                teamsByLeague[league].forEach(function(team) {
                    const option = new Option(team.text, team.value);
                    teamsDropdown.add(option);
                });
            }

            if (league) {
                customNotificationDiv.style.display = "block";
            } else {
                customNotificationDiv.style.display = "none";
            }

            document.getElementById('placeholderLabel').innerText = league;
        }
    </script>
</head>
<body>
    <h1>MYTEAM: for the fans</h1>

    <form onsubmit="handleSubmit(event)">
        <label for="sport">I want to follow: </label>
        <select id="sport" name="sport">
            <option value="football">Football</option>
        </select>
    
        <br><br>
        <label for="league">I want to follow: </label>
        <select id="league" name="league" onchange="updateTeams()"> 
            <option value="">Please select a league</option>
            <option value="EPL">EPL (Football)</option>
            <option value="La Liga">La Liga (Football)</option>
        </select>

        <br><br>
        <label for="team">Team I want to follow:</label>
        <select id="team" name="team">
            <option value="">Select a team</option>
        </select>

        <form>
            <br><br>
            <div id="customNotificationDiv" style="display: none;">
                <label for="customNotification">Notify me when my team plays a <span id="placeholderLabel">$SELECTION_PLACEHOLDER$</span> team that is in the:</label>
                <select id="customNotification" name="customNotification">
                    <option value="top3">Top 3</option>
                    <option value="top5">Top 5</option>
                    <option value="top10">Top 10</option>
                </select>
            </div>
            
            <br><br>
            <input type="checkbox" id="notify" name="notify">
            <label for="notify">Notify me</label>
        
            <label for="email">on my email:</label>
            <input type="email" id="email" name="email" placeholder="Enter your email">
        
            <button type="button" onclick="handleSubmit(event)">Submit</button>
        </form>

        <br><br>
        <div id="message"></div> 

    
</body>
</html>

